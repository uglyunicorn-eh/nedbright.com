---
import { getCollection } from "astro:content";

import Layout from "src/layouts/SimpleWithNavigation.astro";
import { BooksList, FeaturedBookHero } from "src/components/astro";

import { sample } from "src/utils";

const featuredBook = sample(
  await getCollection("books", (entry) => entry.data.isFeatured),
);

const books = await getCollection(
  "books",
  (entry) => entry.id !== featuredBook?.id,
);
---

<Layout
  seo={{
    title: "Библиотека",
    description:
      "Здесь вы найдете книги, рабочие тетради и другие материалы для самостоятельного изучения и практики",
    openGraph: {
      basic: {
        type: "website",
        title: "Библиотека",
        image: featuredBook?.data.image.src!,
      },
    },
    twitter: featuredBook && {
      card: "summary_large_image",
      title: featuredBook.data.title,
      image: featuredBook.data.image.src!,
      imageAlt: featuredBook.data.title,
      description: featuredBook.data.headline,
    },
  }}
>
  {featuredBook && <FeaturedBookHero book={featuredBook} />}
  <BooksList books={books} />
</Layout>
